{
  "id": "openclaw-hybrid-memory",
  "kind": "memory",
  "version": "2026.2.176",
  "uiHints": {
    "embedding.apiKey": {
      "label": "OpenAI API Key",
      "sensitive": true,
      "placeholder": "sk-proj-...",
      "help": "API key for OpenAI embeddings (or use ${OPENAI_API_KEY})"
    },
    "embedding.model": {
      "label": "Embedding Model",
      "placeholder": "text-embedding-3-small",
      "help": "OpenAI embedding model to use"
    },
    "lanceDbPath": {
      "label": "LanceDB Path",
      "placeholder": "~/.openclaw/memory/lancedb",
      "advanced": true
    },
    "sqlitePath": {
      "label": "SQLite Path",
      "placeholder": "~/.openclaw/memory/facts.db",
      "advanced": true
    },
    "autoCapture": {
      "label": "Auto-Capture",
      "help": "Automatically capture important information from conversations"
    },
    "autoRecall": {
      "label": "Auto-Recall",
      "help": "Inject relevant memories (true/false or object with enabled, maxTokens, maxPerMemoryChars)"
    },
    "autoRecall.maxTokens": {
      "label": "Auto-Recall max tokens",
      "help": "Cap on total tokens injected (default 800)"
    },
    "autoRecall.maxPerMemoryChars": {
      "label": "Auto-Recall max chars per memory",
      "help": "Truncate each memory to N chars; 0 = no truncation"
    },
    "autoRecall.injectionFormat": {
      "label": "Auto-Recall injection format",
      "help": "full | short | minimal | progressive | progressive_hybrid (progressive = index; progressive_hybrid = pinned in full + rest as index)"
    },
    "autoRecall.limit": {
      "label": "Auto-Recall limit",
      "help": "Max memories to consider for injection (default 10)"
    },
    "autoRecall.minScore": {
      "label": "Auto-Recall min score",
      "help": "Vector search minimum score 0–1 (default 0.3)"
    },
    "autoRecall.preferLongTerm": {
      "label": "Auto-Recall prefer long-term",
      "help": "Boost score for permanent/stable facts so they rank higher when scores are close (default false)"
    },
    "autoRecall.useImportanceRecency": {
      "label": "Auto-Recall use importance/recency",
      "help": "Combine relevance with importance and lastConfirmedAt so more important or recently confirmed facts rank higher (default false)"
    },
    "autoRecall.entityLookup": {
      "label": "Auto-Recall entity lookup",
      "help": "When prompt mentions an entity from the list, merge lookup(entity) facts into candidates (4.1)"
    },
    "autoRecall.summaryThreshold": {
      "label": "Summary threshold (chars)",
      "help": "Facts longer than this get a summary stored; 0 = disabled (default 300)"
    },
    "autoRecall.summaryMaxChars": {
      "label": "Summary max chars",
      "help": "Length of generated summary (default 80)"
    },
    "autoRecall.useSummaryInInjection": {
      "label": "Use summary in injection",
      "help": "Inject summary instead of full text when present (default true)"
    },
    "autoRecall.summarizeWhenOverBudget": {
      "label": "Summarize when over budget",
      "help": "When token cap forces dropping memories, LLM-summarize all into 2-3 sentences (1.4)"
    },
    "autoRecall.summarizeModel": {
      "label": "Summarize model",
      "placeholder": "gpt-4o-mini",
      "help": "Model for summarize-when-over-budget (default gpt-4o-mini)"
    },
    "autoRecall.progressiveMaxCandidates": {
      "label": "Progressive max candidates",
      "help": "Max memories in progressive index (default 15). Used when injectionFormat is progressive or progressive_hybrid."
    },
    "autoRecall.progressiveIndexMaxTokens": {
      "label": "Progressive index max tokens",
      "help": "Token cap for the index block in progressive mode (default: 300 when injectionFormat is progressive or progressive_hybrid)"
    },
    "autoRecall.progressiveGroupByCategory": {
      "label": "Progressive group by category",
      "help": "Group index lines by category for readability (default false)"
    },
    "autoRecall.progressivePinnedRecallCount": {
      "label": "Progressive pinned recall count",
      "help": "In progressive_hybrid: facts with recallCount >= this or permanent decay are injected in full (default 3)"
    },
    "captureMaxChars": {
      "label": "Capture max characters",
      "help": "Max characters per fact: filter in auto-capture and truncate when storing (default 5000)"
    },
    "categories": {
      "label": "Custom Categories",
      "help": "Additional memory categories beyond the defaults (preference, fact, decision, entity, other)"
    },
    "autoClassify.enabled": {
      "label": "Auto-Classify",
      "help": "Use a cheap LLM to classify 'other' facts into proper categories on capture and via CLI"
    },
    "autoClassify.model": {
      "label": "Classify Model",
      "placeholder": "gpt-4.1-nano",
      "help": "Cheap/fast model for classification (e.g. gpt-4.1-nano, gpt-4o-mini)"
    },
    "autoClassify.suggestCategories": {
      "label": "Suggest categories",
      "help": "Let LLM suggest new categories from 'other' facts; labels with ≥ minFactsForNewCategory become real categories"
    },
    "autoClassify.minFactsForNewCategory": {
      "label": "Min facts for new category",
      "help": "Minimum facts with same suggested label before creating that category (default 10); not told to the LLM"
    },
    "store.fuzzyDedupe": {
      "label": "Store fuzzy dedupe",
      "help": "Skip storing when normalized text (trim, collapse whitespace, lowercase) matches an existing fact (2.3)"
    },
    "store.classifyBeforeWrite": {
      "label": "Classify before write (FR-008)",
      "help": "Classify each new fact as ADD/UPDATE/DELETE/NOOP against similar facts before storing; reduces duplicates and contradictions"
    },
    "store.classifyModel": {
      "label": "Classification model",
      "placeholder": "gpt-4o-mini",
      "help": "Chat model for memory operation classification (default: gpt-4o-mini)"
    },
    "credentials.enabled": {
      "label": "Credentials",
      "help": "Opt-in encrypted credential store for API keys, tokens, passwords"
    },
    "credentials.encryptionKey": {
      "label": "Credentials encryption key",
      "sensitive": true,
      "placeholder": "env:OPENCLAW_CRED_KEY",
      "help": "Use env:VAR_NAME (e.g. env:OPENCLAW_CRED_KEY) or provide 16+ char secret"
    },
    "credentials.autoDetect": {
      "label": "Credential auto-detect",
      "help": "When enabled, detect API keys/tokens in conversation and prompt to store"
    },
    "credentials.expiryWarningDays": {
      "label": "Expiry warning days",
      "help": "Warn when credentials expire within this many days (default 7)"
    },
    "wal.enabled": {
      "label": "Write-Ahead Log",
      "help": "Enable WAL for crash resilience - logs memory operations before committing (default: enabled)"
    },
    "wal.walPath": {
      "label": "WAL file path",
      "advanced": true,
      "help": "Custom path for WAL file (default: same directory as SQLite DB)"
    },
    "wal.maxAge": {
      "label": "WAL max age (ms)",
      "advanced": true,
      "help": "Maximum age of WAL entries before considered stale in milliseconds (default: 300000 = 5 minutes)"
    },
    "personaProposals.enabled": {
      "label": "Persona Proposals",
      "help": "Opt-in agent self-evolution: agents can propose changes to identity files (SOUL.md, IDENTITY.md, USER.md) with human approval gate (default: disabled)"
    },
    "personaProposals.allowedFiles": {
      "label": "Allowed identity files",
      "help": "Identity files that can be modified via proposals (default: all three)"
    },
    "personaProposals.maxProposalsPerWeek": {
      "label": "Max proposals per week",
      "help": "Rate limit to prevent proposal spam (default: 5)"
    },
    "personaProposals.minConfidence": {
      "label": "Min confidence",
      "help": "Minimum confidence score 0-1 for proposals (default: 0.7)"
    },
    "personaProposals.proposalTTLDays": {
      "label": "Proposal TTL (days)",
      "help": "Days before proposals auto-expire if not reviewed (default: 30, 0 = never)"
    },
    "personaProposals.minSessionEvidence": {
      "label": "Min session evidence",
      "help": "Minimum number of session references required (default: 10)"
    },
    "graph.enabled": {
      "label": "Graph memory",
      "help": "Enable graph-based spreading activation for zero-LLM recall (FR-007)"
    },
    "graph.autoLink": {
      "label": "Auto-link",
      "help": "Auto-create RELATED_TO links to similar facts when storing (default false)"
    },
    "graph.autoLinkMinScore": {
      "label": "Auto-link min score",
      "help": "Min similarity score for auto-linking (default 0.7)"
    },
    "graph.autoLinkLimit": {
      "label": "Auto-link limit",
      "help": "Max similar facts to link per storage (default 3)"
    },
    "graph.maxTraversalDepth": {
      "label": "Max traversal depth",
      "help": "Max hops for graph traversal in recall (default 2)"
    },
    "graph.useInRecall": {
      "label": "Use in recall",
      "help": "Enable graph traversal in memory_recall (default true)"
    },
    "procedures.enabled": {
      "label": "Procedural memory",
      "help": "Extract tool-call procedures from session logs, inject in recall, auto-generate skills (issue #23)"
    },
    "procedures.sessionsDir": {
      "label": "Session directory",
      "help": "Path to session JSONL files (default: ~/.openclaw/agents/main/sessions)"
    },
    "procedures.minSteps": {
      "label": "Min steps",
      "help": "Minimum tool steps to count as a procedure (default: 2)"
    },
    "procedures.validationThreshold": {
      "label": "Validation threshold",
      "help": "Success count before auto-generating a skill (default: 3)"
    },
    "procedures.skillTTLDays": {
      "label": "Skill TTL (days)",
      "help": "Procedure confidence TTL / revalidation window (default: 30)"
    },
    "procedures.skillsAutoPath": {
      "label": "Auto-skills path",
      "help": "Path for auto-generated skills (default: skills/auto)"
    },
    "distill.apiKey": {
      "label": "Gemini API Key (distill)",
      "sensitive": true,
      "help": "For session distillation with Gemini (1M context). Or set GOOGLE_API_KEY env."
    },
    "distill.defaultModel": {
      "label": "Distill default model",
      "placeholder": "gemini-3-pro-preview",
      "help": "Default LLM for hybrid-mem distill (recommended: gemini-3-pro-preview for 1M context and token I/O)"
    },
    "languageKeywords.autoBuild": {
      "label": "Multi-language auto-build",
      "help": "Build .language-keywords.json from memory samples (triggers, categories, correction signals). Once at startup if missing, then weekly."
    },
    "languageKeywords.weeklyIntervalDays": {
      "label": "Language keywords interval (days)",
      "help": "Days between auto-builds (1–30, default 7)"
    },
    "reflection.enabled": {
      "label": "Reflection layer (FR-011)",
      "help": "Synthesize behavioral patterns from facts; memory_reflect, reflect-rules"
    },
    "reflection.model": {
      "label": "Reflection model",
      "placeholder": "gpt-4o-mini",
      "help": "LLM for reflection analysis"
    },
    "reflection.defaultWindow": {
      "label": "Reflection window (days)",
      "help": "Time window for fact gathering (default 14)"
    },
    "reflection.minObservations": {
      "label": "Reflection min observations",
      "help": "Min observations to support a pattern (default 2)"
    },
    "procedures.enabled": {
      "label": "Procedural memory",
      "help": "Extract tool-call procedures from session logs, inject in recall, auto-generate skills (issue #23)"
    },
    "procedures.sessionsDir": {
      "label": "Session directory",
      "help": "Path to session JSONL files (default: ~/.openclaw/agents/main/sessions)"
    },
    "procedures.minSteps": {
      "label": "Min steps",
      "help": "Minimum tool steps to count as a procedure (default: 2)"
    },
    "procedures.validationThreshold": {
      "label": "Validation threshold",
      "help": "Success count before auto-generating a skill (default: 3)"
    },
    "procedures.skillTTLDays": {
      "label": "Skill TTL (days)",
      "help": "Procedure confidence TTL / revalidation window (default: 30)"
    },
    "procedures.skillsAutoPath": {
      "label": "Auto-skills path",
      "help": "Path for auto-generated skills (default: skills/auto)"
    }
  },
  "configSchema": {
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "embedding": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "apiKey": { "type": "string" },
          "model": {
            "type": "string",
            "enum": ["text-embedding-3-small", "text-embedding-3-large"]
          }
        },
        "required": ["apiKey"]
      },
      "lanceDbPath": { "type": "string" },
      "sqlitePath": { "type": "string" },
      "autoCapture": { "type": "boolean" },
      "autoRecall": {
        "oneOf": [
          { "type": "boolean" },
          {
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "enabled": { "type": "boolean" },
              "maxTokens": { "type": "number" },
              "maxPerMemoryChars": { "type": "number" },
              "injectionFormat": {
                "type": "string",
                "enum": ["full", "short", "minimal", "progressive", "progressive_hybrid"]
              },
              "progressiveMaxCandidates": { "type": "number" },
              "progressiveIndexMaxTokens": { "type": "number" },
              "progressiveGroupByCategory": { "type": "boolean" },
              "progressivePinnedRecallCount": { "type": "number" },
              "limit": { "type": "number" },
              "minScore": { "type": "number" },
              "preferLongTerm": { "type": "boolean" },
              "useImportanceRecency": { "type": "boolean" },
              "entityLookup": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "enabled": { "type": "boolean" },
                  "entities": { "type": "array", "items": { "type": "string" } },
                  "maxFactsPerEntity": { "type": "number" }
                }
              },
              "summaryThreshold": { "type": "number" },
              "summaryMaxChars": { "type": "number" },
              "useSummaryInInjection": { "type": "boolean" },
              "summarizeWhenOverBudget": { "type": "boolean" },
              "summarizeModel": { "type": "string" }
            }
          }
        ]
      },
      "captureMaxChars": { "type": "number" },
      "categories": {
        "type": "array",
        "items": { "type": "string" },
        "description": "Custom categories to add alongside defaults"
      },
      "autoClassify": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "enabled": { "type": "boolean" },
          "model": { "type": "string" },
          "batchSize": { "type": "number" },
          "suggestCategories": { "type": "boolean" },
          "minFactsForNewCategory": { "type": "number" }
        }
      },
      "store": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "fuzzyDedupe": { "type": "boolean" },
          "classifyBeforeWrite": { "type": "boolean", "description": "FR-008: Classify incoming fact against similar facts (ADD/UPDATE/DELETE/NOOP) before storing" },
          "classifyModel": { "type": "string", "description": "Model for classification (default: gpt-4o-mini)" }
        }
      },
      "credentials": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "enabled": { "type": "boolean" },
          "store": { "type": "string", "enum": ["sqlite"] },
          "encryptionKey": { "type": "string" },
          "autoDetect": { "type": "boolean", "description": "Detect credential patterns in conversation and prompt to store" },
          "expiryWarningDays": { "type": "number", "description": "Days before expiry to warn (default 7)" }
        },
        "description": "Opt-in credential store: enabled=true, encryptionKey=env:OPENCLAW_CRED_KEY"
      },
      "distill": {
        "type": "object",
        "additionalProperties": false,
        "description": "Gemini for session distillation (1M context). Optional; use env GOOGLE_API_KEY if not set.",
        "properties": {
          "apiKey": { "type": "string", "description": "Gemini/Google API key or env:VAR_NAME" },
          "defaultModel": { "type": "string", "description": "Default model for distill (recommended: gemini-3-pro-preview)" }
        }
      },
      "languageKeywords": {
        "type": "object",
        "additionalProperties": false,
        "description": "Multi-language detection: auto-build .language-keywords.json from memory samples (triggers, categories, correction signals).",
        "properties": {
          "autoBuild": { "type": "boolean", "description": "When true, build once at startup if file missing, then weekly (default: true)" },
          "weeklyIntervalDays": { "type": "number", "minimum": 1, "maximum": 30, "description": "Days between auto-builds (default: 7)" }
        }
      },
      "reflection": {
        "type": "object",
        "additionalProperties": false,
        "description": "FR-011: Synthesize behavioral patterns from facts (memory_reflect, reflect-rules).",
        "properties": {
          "enabled": { "type": "boolean", "description": "Enable reflection layer (default: false)" },
          "model": { "type": "string", "description": "LLM for reflection (default: gpt-4o-mini)" },
          "defaultWindow": { "type": "number", "description": "Time window in days for fact gathering (default: 14)" },
          "minObservations": { "type": "number", "description": "Min observations to support a pattern (default: 2)" }
        }
      },
      "wal": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "enabled": { "type": "boolean", "description": "Enable Write-Ahead Log for crash resilience (default: true)" },
          "walPath": { "type": "string", "description": "Path to WAL file (default: same directory as SQLite DB)" },
          "maxAge": { "type": "number", "description": "Maximum age of WAL entries before considered stale in ms (default: 300000 = 5 minutes)" }
        },
        "description": "Write-Ahead Log for crash resilience (enabled by default)"
      },
      "personaProposals": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "enabled": { "type": "boolean", "description": "Enable agent self-evolution via gated persona proposals (default: false)" },
          "allowedFiles": {
            "type": "array",
            "items": { "type": "string", "enum": ["SOUL.md", "IDENTITY.md", "USER.md"] },
            "description": "Identity files that can be modified via proposals"
          },
          "maxProposalsPerWeek": { "type": "number", "description": "Max proposals per week to prevent spam (default: 5)" },
          "minConfidence": { "type": "number", "minimum": 0, "maximum": 1, "description": "Min confidence score for proposals (default: 0.7)" },
          "proposalTTLDays": { "type": "number", "description": "Days before proposals auto-expire (default: 30, 0 = never)" },
          "minSessionEvidence": { "type": "number", "description": "Min session evidence count (default: 10)" }
        },
        "description": "Opt-in persona proposals: agent self-evolution with human approval gate (disabled by default)"
      },
      "graph": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "enabled": { "type": "boolean", "description": "Enable graph-based spreading activation for zero-LLM recall (FR-007)" },
          "autoLink": { "type": "boolean", "description": "Auto-create RELATED_TO links to similar facts when storing (default: false)" },
          "autoLinkMinScore": { "type": "number", "minimum": 0, "maximum": 1, "description": "Min similarity score for auto-linking (default: 0.7)" },
          "autoLinkLimit": { "type": "number", "description": "Max similar facts to link per storage (default: 3)" },
          "maxTraversalDepth": { "type": "number", "description": "Max hops for graph traversal in recall (default: 2)" },
          "useInRecall": { "type": "boolean", "description": "Enable graph traversal in memory_recall (default: true)" }
        },
        "description": "Graph-based spreading activation: typed relationships for zero-LLM recall"
      },
      "procedures": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "enabled": { "type": "boolean", "description": "Enable procedural memory (default: true)" },
          "sessionsDir": { "type": "string", "description": "Session JSONL directory (default: ~/.openclaw/agents/main/sessions)" },
          "minSteps": { "type": "number", "description": "Min tool steps per procedure (default: 2)" },
          "validationThreshold": { "type": "number", "description": "Validations before auto-skill (default: 3)" },
          "skillTTLDays": { "type": "number", "description": "Procedure TTL days (default: 30)" },
          "skillsAutoPath": { "type": "string", "description": "Path for auto-generated skills (default: skills/auto)" },
          "requireApprovalForPromote": { "type": "boolean", "description": "Require human move to promote auto-skill (default: true)" }
        },
        "description": "Procedural memory: auto-generated skills from learned patterns (issue #23)"
      },
      "selfCorrection": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "semanticDedup": { "type": "boolean", "description": "Skip storing facts that are semantically similar to existing ones (default: true)" },
          "semanticDedupThreshold": { "type": "number", "minimum": 0, "maximum": 1, "description": "Similarity threshold for semantic dedup, 0-1 (default: 0.92)" },
          "toolsSection": { "type": "string", "description": "TOOLS.md section heading for new rules (default: Self-correction rules)" },
          "applyToolsByDefault": { "type": "boolean", "description": "When true (default), insert suggested TOOLS rules under toolsSection. Set false to only suggest (use --approve to apply). Use --no-apply-tools to skip applying for one run." },
          "autoRewriteTools": { "type": "boolean", "description": "When true, LLM rewrites TOOLS.md to integrate new rules (no duplicates/contradictions). When false, use section insert (default: false)" },
          "analyzeViaSpawn": { "type": "boolean", "description": "When true and incidents > spawnThreshold, run Phase 2 via openclaw sessions spawn (Gemini, large context) (default: false)" },
          "spawnThreshold": { "type": "number", "description": "Use spawn for Phase 2 when incident count exceeds this (default: 15)" },
          "spawnModel": { "type": "string", "description": "Model for spawn when analyzeViaSpawn is true (default: gemini)" }
        },
        "description": "Self-correction analysis (issue #34): semantic dedup, TOOLS sectioning, auto-rewrite vs approve, optional Phase 2 via spawn"
      }
    },
    "required": ["embedding"]
  }
}
