{
  "id": "openclaw-hybrid-memory",
  "kind": "memory",
  "version": "2026.02.240",
  "uiHints": {
    "embedding.apiKey": {
      "label": "OpenAI API Key",
      "sensitive": true,
      "placeholder": "sk-proj-...",
      "help": "API key for OpenAI embeddings (or use ${OPENAI_API_KEY})"
    },
    "embedding.model": {
      "label": "Embedding Model",
      "placeholder": "text-embedding-3-small",
      "help": "OpenAI embedding model to use"
    },
    "mode": {
      "label": "Configuration preset",
      "placeholder": "normal",
      "help": "essential | normal | expert | full. See CONFIGURATION-MODES.md."
    },
    "lanceDbPath": {
      "label": "LanceDB Path",
      "placeholder": "~/.openclaw/memory/lancedb",
      "advanced": true
    },
    "sqlitePath": {
      "label": "SQLite Path",
      "placeholder": "~/.openclaw/memory/facts.db",
      "advanced": true
    },
    "autoCapture": {
      "label": "Auto-Capture",
      "help": "Automatically capture important information from conversations"
    },
    "autoRecall": {
      "label": "Auto-Recall",
      "help": "Inject relevant memories (true/false or object with enabled, maxTokens, maxPerMemoryChars)"
    },
    "autoRecall.maxTokens": {
      "label": "Auto-Recall max tokens",
      "help": "Cap on total tokens injected (default 800)"
    },
    "autoRecall.maxPerMemoryChars": {
      "label": "Auto-Recall max chars per memory",
      "help": "Truncate each memory to N chars; 0 = no truncation"
    },
    "autoRecall.injectionFormat": {
      "label": "Auto-Recall injection format",
      "help": "full | short | minimal | progressive | progressive_hybrid (progressive = index; progressive_hybrid = pinned in full + rest as index)"
    },
    "autoRecall.limit": {
      "label": "Auto-Recall limit",
      "help": "Max memories to consider for injection (default 10)"
    },
    "autoRecall.minScore": {
      "label": "Auto-Recall min score",
      "help": "Vector search minimum score 0–1 (default 0.3)"
    },
    "autoRecall.preferLongTerm": {
      "label": "Auto-Recall prefer long-term",
      "help": "Boost score for permanent/stable facts so they rank higher when scores are close (default false)"
    },
    "autoRecall.useImportanceRecency": {
      "label": "Auto-Recall use importance/recency",
      "help": "Combine relevance with importance and lastConfirmedAt so more important or recently confirmed facts rank higher (default false)"
    },
    "autoRecall.entityLookup": {
      "label": "Auto-Recall entity lookup",
      "help": "When prompt mentions an entity from the list, merge lookup(entity) facts into candidates (4.1)"
    },
    "autoRecall.summaryThreshold": {
      "label": "Summary threshold (chars)",
      "help": "Facts longer than this get a summary stored; 0 = disabled (default 300)"
    },
    "autoRecall.summaryMaxChars": {
      "label": "Summary max chars",
      "help": "Length of generated summary (default 80)"
    },
    "autoRecall.useSummaryInInjection": {
      "label": "Use summary in injection",
      "help": "Inject summary instead of full text when present (default true)"
    },
    "autoRecall.summarizeWhenOverBudget": {
      "label": "Summarize when over budget",
      "help": "When token cap forces dropping memories, LLM-summarize all into 2-3 sentences (1.4)"
    },
    "autoRecall.summarizeModel": {
      "label": "Summarize model",
      "placeholder": "e.g. flash, sonnet",
      "help": "Model for summarize-when-over-budget (when unset, resolved at runtime)"
    },
    "autoRecall.progressiveMaxCandidates": {
      "label": "Progressive max candidates",
      "help": "Max memories in progressive index (default 15). Used when injectionFormat is progressive or progressive_hybrid."
    },
    "autoRecall.progressiveIndexMaxTokens": {
      "label": "Progressive index max tokens",
      "help": "Token cap for the index block in progressive mode (default: 300 when injectionFormat is progressive or progressive_hybrid)"
    },
    "autoRecall.progressiveGroupByCategory": {
      "label": "Progressive group by category",
      "help": "Group index lines by category for readability (default false)"
    },
    "autoRecall.progressivePinnedRecallCount": {
      "label": "Progressive pinned recall count",
      "help": "In progressive_hybrid: facts with recallCount >= this or permanent decay are injected in full (default 3)"
    },
    "autoRecall.authFailure.enabled": {
      "label": "Auth failure auto-recall",
      "help": "Detect authentication failures and auto-inject relevant credentials (default: true)"
    },
    "autoRecall.authFailure.patterns": {
      "label": "Auth failure patterns",
      "help": "Additional regex patterns to detect auth failures (merged with defaults). Should NOT include default patterns to avoid duplication."
    },
    "autoRecall.authFailure.maxRecallsPerTarget": {
      "label": "Max recalls per target",
      "help": "Max times to recall credentials for the same target per session. 0 = unlimited (default: 1)"
    },
    "autoRecall.authFailure.includeVaultHints": {
      "label": "Include vault hints",
      "help": "Inject credential hints even if they're stored in the vault (default: true)"
    },
    "captureMaxChars": {
      "label": "Capture max characters",
      "help": "Max characters per fact: filter in auto-capture and truncate when storing (default 5000)"
    },
    "categories": {
      "label": "Custom Categories",
      "help": "Additional memory categories beyond the defaults (preference, fact, decision, entity, other)"
    },
    "autoClassify.enabled": {
      "label": "Auto-Classify",
      "help": "Use a cheap LLM to classify 'other' facts into proper categories on capture and via CLI"
    },
    "autoClassify.model": {
      "label": "Classify Model",
      "placeholder": "e.g. flash, sonnet",
      "help": "Cheap/fast model for classification (when unset, resolved at runtime)"
    },
    "autoClassify.suggestCategories": {
      "label": "Suggest categories",
      "help": "Let LLM suggest new categories from 'other' facts; labels with ≥ minFactsForNewCategory become real categories"
    },
    "autoClassify.minFactsForNewCategory": {
      "label": "Min facts for new category",
      "help": "Minimum facts with same suggested label before creating that category (default 10); not told to the LLM"
    },
    "store.fuzzyDedupe": {
      "label": "Store fuzzy dedupe",
      "help": "Skip storing when normalized text (trim, collapse whitespace, lowercase) matches an existing fact (2.3)"
    },
    "store.classifyBeforeWrite": {
      "label": "Classify before write",
      "help": "Classify each new fact as ADD/UPDATE/DELETE/NOOP against similar facts before storing; reduces duplicates and contradictions"
    },
    "store.classifyModel": {
      "label": "Classification model",
      "placeholder": "e.g. flash, sonnet",
      "help": "Chat model for memory operation classification (when unset, resolved at runtime)"
    },
    "credentials.enabled": {
      "label": "Credentials",
      "help": "Opt-in encrypted credential store for API keys, tokens, passwords"
    },
    "credentials.encryptionKey": {
      "label": "Credentials encryption key",
      "sensitive": true,
      "placeholder": "env:OPENCLAW_CRED_KEY",
      "help": "Use env:VAR_NAME (e.g. env:OPENCLAW_CRED_KEY) or provide 16+ char secret"
    },
    "credentials.autoDetect": {
      "label": "Credential auto-detect",
      "help": "When enabled, detect API keys/tokens in conversation and prompt to store"
    },
    "credentials.expiryWarningDays": {
      "label": "Expiry warning days",
      "help": "Warn when credentials expire within this many days (default 7)"
    },
    "errorReporting.enabled": {
      "label": "Error reporting enabled",
      "help": "Send anonymous error reports to help developers prioritize bug fixes (default: false, opt-in)"
    },
    "errorReporting.consent": {
      "label": "Error reporting consent",
      "help": "Explicit user consent required for error reporting (default: false)"
    },
    "errorReporting.mode": {
      "label": "Error reporting mode",
      "help": "community (anonymous telemetry to developers) or self-hosted (your own Sentry/GlitchTip instance). Default: community"
    },
    "errorReporting.dsn": {
      "label": "Error reporting DSN",
      "sensitive": true,
      "placeholder": "https://<key>@your-instance.example/1",
      "help": "Custom DSN for self-hosted mode. Not needed for community mode."
    },
    "errorReporting.environment": {
      "label": "Error reporting environment",
      "placeholder": "production",
      "help": "Environment tag for reported errors (default: production)"
    },
    "errorReporting.sampleRate": {
      "label": "Error reporting sample rate",
      "help": "Fraction of errors to report 0–1 (default: 1.0)"
    },
    "errorReporting.botId": {
      "label": "Error reporting bot ID (UUID)",
      "placeholder": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
      "help": "Set this bot's UUID to include it in error reports (GlitchTip groups by bot). Use config-set errorReporting.botId <uuid>. Clear or omit to not send bot ID."
    },
    "errorReporting.botName": {
      "label": "Error reporting friendly name",
      "placeholder": "Maeve",
      "help": "Friendly name for this bot (e.g. Maeve, Doris); shown in GlitchTip reports. Use config-set errorReporting.botName \"Doris\"."
    },
    "wal.enabled": {
      "label": "Write-Ahead Log",
      "help": "Enable WAL for crash resilience - logs memory operations before committing (default: enabled)"
    },
    "wal.walPath": {
      "label": "WAL file path",
      "advanced": true,
      "help": "Custom path for WAL file (default: same directory as SQLite DB)"
    },
    "wal.maxAge": {
      "label": "WAL max age (ms)",
      "advanced": true,
      "help": "Maximum age of WAL entries before considered stale in milliseconds (default: 300000 = 5 minutes)"
    },
    "personaProposals.enabled": {
      "label": "Persona Proposals",
      "help": "Opt-in agent self-evolution: agents can propose changes to identity files (SOUL.md, IDENTITY.md, USER.md) with human approval gate (default: disabled)"
    },
    "personaProposals.allowedFiles": {
      "label": "Allowed identity files",
      "help": "Identity files that can be modified via proposals (default: all three)"
    },
    "personaProposals.maxProposalsPerWeek": {
      "label": "Max proposals per week",
      "help": "Rate limit to prevent proposal spam (default: 5)"
    },
    "personaProposals.minConfidence": {
      "label": "Min confidence",
      "help": "Minimum confidence score 0-1 for proposals (default: 0.7)"
    },
    "personaProposals.proposalTTLDays": {
      "label": "Proposal TTL (days)",
      "help": "Days before proposals auto-expire if not reviewed (default: 30, 0 = never)"
    },
    "personaProposals.minSessionEvidence": {
      "label": "Min session evidence",
      "help": "Minimum number of session references required (default: 10)"
    },
    "graph.enabled": {
      "label": "Graph memory",
      "help": "Enable graph-based spreading activation for zero-LLM recall"
    },
    "graph.autoLink": {
      "label": "Auto-link",
      "help": "Auto-create RELATED_TO links to similar facts when storing (default false)"
    },
    "graph.autoLinkMinScore": {
      "label": "Auto-link min score",
      "help": "Min similarity score for auto-linking (default 0.7)"
    },
    "graph.autoLinkLimit": {
      "label": "Auto-link limit",
      "help": "Max similar facts to link per storage (default 3)"
    },
    "graph.maxTraversalDepth": {
      "label": "Max traversal depth",
      "help": "Max hops for graph traversal in recall (default 2)"
    },
    "graph.useInRecall": {
      "label": "Use in recall",
      "help": "Enable graph traversal in memory_recall (default true)"
    },
    "procedures.enabled": {
      "label": "Procedural memory",
      "help": "Extract tool-call procedures from session logs, inject in recall, auto-generate skills"
    },
    "procedures.sessionsDir": {
      "label": "Session directory",
      "help": "Path to session JSONL files (default: ~/.openclaw/agents/main/sessions)"
    },
    "procedures.minSteps": {
      "label": "Min steps",
      "help": "Minimum tool steps to count as a procedure (default: 2)"
    },
    "procedures.validationThreshold": {
      "label": "Validation threshold",
      "help": "Success count before auto-generating a skill (default: 3)"
    },
    "procedures.skillTTLDays": {
      "label": "Skill TTL (days)",
      "help": "Procedure confidence TTL / revalidation window (default: 30)"
    },
    "procedures.skillsAutoPath": {
      "label": "Auto-skills path",
      "help": "Path for auto-generated skills (default: skills/auto)"
    },
    "distill.apiKey": {
      "label": "Gemini API Key (distill)",
      "sensitive": true,
      "help": "For session distillation with Gemini (1M context). Or set GOOGLE_API_KEY env."
    },
    "distill.defaultModel": {
      "label": "Distill default model",
      "placeholder": "gemini-3-pro-preview",
      "help": "Default LLM for hybrid-mem distill (recommended: gemini-3-pro-preview for 1M context and token I/O)"
    },
    "languageKeywords.autoBuild": {
      "label": "Multi-language auto-build",
      "help": "Build .language-keywords.json from memory samples (triggers, categories, correction signals). Once at startup if missing, then weekly."
    },
    "languageKeywords.weeklyIntervalDays": {
      "label": "Language keywords interval (days)",
      "help": "Days between auto-builds (1–30, default 7)"
    },
    "reflection.enabled": {
      "label": "Reflection layer",
      "help": "Synthesize behavioral patterns from facts; memory_reflect, reflect-rules"
    },
    "reflection.model": {
      "label": "Reflection model",
      "placeholder": "e.g. flash, sonnet",
      "help": "LLM for reflection analysis (when unset, resolved at runtime)"
    },
    "reflection.defaultWindow": {
      "label": "Reflection window (days)",
      "help": "Time window for fact gathering (default 14)"
    },
    "reflection.minObservations": {
      "label": "Reflection min observations",
      "help": "Min observations to support a pattern (default 2)"
    },
    "memoryToSkills.enabled": {
      "label": "Memory-to-skills",
      "help": "Cluster procedures and draft skills to skills/auto-generated/ (nightly or skills-suggest)"
    },
    "memoryToSkills.schedule": {
      "label": "Memory-to-skills schedule",
      "help": "Cron for nightly run (default 0 2 * * *)"
    },
    "memoryToSkills.windowDays": {
      "label": "Memory-to-skills window (days)",
      "help": "Procedures updated in last N days (default 30)"
    },
    "multiAgent.orchestratorId": {
      "label": "Orchestrator Agent ID",
      "placeholder": "main",
      "help": "Agent ID of the orchestrator (main agent). This agent sees all scopes. Default: 'main'."
    },
    "multiAgent.defaultStoreScope": {
      "label": "Default Store Scope",
      "placeholder": "global",
      "help": "Default scope for new facts: 'global' (all agents, backward compatible), 'agent' (specialists auto-scope), or 'auto' (orchestrator→global, specialists→agent). Default: 'global'."
    }
  },
  "configSchema": {
    "type": "object",
    "additionalProperties": true,
    "properties": {
      "mode": {
        "type": "string",
        "enum": [
          "essential",
          "normal",
          "expert",
          "full"
        ],
        "description": "Configuration preset. See docs/CONFIGURATION-MODES.md."
      },
      "embedding": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "apiKey": {
            "type": "string"
          },
          "model": {
            "type": "string",
            "enum": [
              "text-embedding-3-small",
              "text-embedding-3-large"
            ]
          }
        },
        "required": [
          "apiKey"
        ]
      },
      "lanceDbPath": {
        "type": "string"
      },
      "sqlitePath": {
        "type": "string"
      },
      "autoCapture": {
        "type": "boolean"
      },
      "autoRecall": {
        "oneOf": [
          {
            "type": "boolean"
          },
          {
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "enabled": {
                "type": "boolean"
              },
              "maxTokens": {
                "type": "number"
              },
              "maxPerMemoryChars": {
                "type": "number"
              },
              "injectionFormat": {
                "type": "string",
                "enum": [
                  "full",
                  "short",
                  "minimal",
                  "progressive",
                  "progressive_hybrid"
                ]
              },
              "progressiveMaxCandidates": {
                "type": "number"
              },
              "progressiveIndexMaxTokens": {
                "type": "number"
              },
              "progressiveGroupByCategory": {
                "type": "boolean"
              },
              "progressivePinnedRecallCount": {
                "type": "number"
              },
              "limit": {
                "type": "number"
              },
              "minScore": {
                "type": "number"
              },
              "preferLongTerm": {
                "type": "boolean"
              },
              "useImportanceRecency": {
                "type": "boolean"
              },
              "entityLookup": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "enabled": {
                    "type": "boolean"
                  },
                  "entities": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  },
                  "maxFactsPerEntity": {
                    "type": "number"
                  }
                }
              },
              "summaryThreshold": {
                "type": "number"
              },
              "summaryMaxChars": {
                "type": "number"
              },
              "useSummaryInInjection": {
                "type": "boolean"
              },
              "summarizeWhenOverBudget": {
                "type": "boolean"
              },
              "summarizeModel": {
                "type": "string"
              },
              "authFailure": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "enabled": {
                    "type": "boolean",
                    "description": "Detect authentication failures and auto-inject credentials (default: true)"
                  },
                  "patterns": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Additional regex patterns to detect auth failures (should NOT duplicate defaults)"
                  },
                  "maxRecallsPerTarget": {
                    "type": "number",
                    "minimum": 0,
                    "description": "Max recalls per target per session; 0 = unlimited (default: 1)"
                  },
                  "includeVaultHints": {
                    "type": "boolean",
                    "description": "Inject hints even when credentials are in vault (default: true)"
                  }
                },
                "description": "Auto-recall credentials on authentication failures"
              }
            }
          }
        ]
      },
      "captureMaxChars": {
        "type": "number"
      },
      "categories": {
        "type": "array",
        "items": {
          "type": "string"
        },
        "description": "Custom categories to add alongside defaults"
      },
      "autoClassify": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "enabled": {
            "type": "boolean"
          },
          "model": {
            "type": "string"
          },
          "batchSize": {
            "type": "number"
          },
          "suggestCategories": {
            "type": "boolean"
          },
          "minFactsForNewCategory": {
            "type": "number"
          }
        }
      },
      "store": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "fuzzyDedupe": {
            "type": "boolean"
          },
          "classifyBeforeWrite": {
            "type": "boolean",
            "description": "Classify incoming fact against similar facts (ADD/UPDATE/DELETE/NOOP) before storing"
          },
          "classifyModel": {
            "type": "string",
            "description": "Model for classification (when unset, resolved dynamically at runtime)"
          }
        }
      },
      "credentials": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "enabled": {
            "type": "boolean"
          },
          "store": {
            "type": "string",
            "enum": [
              "sqlite"
            ]
          },
          "encryptionKey": {
            "type": "string",
            "description": "Optional. When set (16+ chars or env:VAR), vault is encrypted. When unset, vault is plaintext; user may secure by other means (e.g. filesystem permissions)."
          },
          "autoDetect": {
            "type": "boolean",
            "description": "Detect credential patterns in conversation and prompt to store"
          },
          "autoCapture": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "toolCalls": {
                "type": "boolean",
                "description": "Scan tool call inputs for credential patterns and store in vault"
              },
              "logCaptures": {
                "type": "boolean",
                "description": "Emit info log on each capture (default: true)"
              },
              "requirePatternMatch": {
                "type": "boolean",
                "description": "Only store when a credential pattern matched (reject value-only; default: false)"
              }
            },
            "description": "Auto-capture credentials from tool call inputs"
          },
          "expiryWarningDays": {
            "type": "number",
            "description": "Days before expiry to warn (default 7)"
          }
        },
        "description": "Credential vault: enabled=true. Optionally set encryptionKey (or env:OPENCLAW_CRED_KEY) for encryption; omit for plaintext vault."
      },
      "errorReporting": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "enabled": {
            "type": "boolean",
            "default": false,
            "description": "Enable error reporting (default: false, opt-in)"
          },
          "consent": {
            "type": "boolean",
            "default": false,
            "description": "Explicit user consent required (default: false)"
          },
          "mode": {
            "type": "string",
            "enum": [
              "community",
              "self-hosted"
            ],
            "default": "community",
            "description": "community: anonymous telemetry to developers. self-hosted: your own Sentry/GlitchTip instance."
          },
          "dsn": {
            "type": "string",
            "description": "Custom DSN for self-hosted mode. Community mode uses built-in endpoint."
          },
          "environment": {
            "type": "string",
            "default": "production",
            "description": "Environment tag (default: production)"
          },
          "sampleRate": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "default": 1,
            "description": "Sample rate 0–1 (default: 1.0)"
          },
          "botId": {
            "type": "string",
            "description": "Optional UUID identifying this bot instance; sent as tag so GlitchTip can group errors by bot."
          },
          "botName": {
            "type": "string",
            "description": "Optional friendly name for this bot (e.g. Maeve, Doris); sent as tag for readable reports."
          }
        },
        "required": [
          "enabled",
          "consent"
        ],
        "description": "Opt-in error reporting to GlitchTip/Sentry. See docs/ERROR-REPORTING.md."
      },
      "distill": {
        "type": "object",
        "additionalProperties": false,
        "description": "Gemini for session distillation (1M context). Optional; use env GOOGLE_API_KEY if not set.",
        "properties": {
          "apiKey": {
            "type": "string",
            "description": "Gemini/Google API key or env:VAR_NAME"
          },
          "defaultModel": {
            "type": "string",
            "description": "Default model for distill (recommended: gemini-3-pro-preview)"
          },
          "extractDirectives": {
            "type": "boolean",
            "description": "Enable directive extraction from sessions (default: true)"
          },
          "extractReinforcement": {
            "type": "boolean",
            "description": "Enable reinforcement extraction from sessions (default: true)"
          },
          "reinforcementBoost": {
            "type": "number",
            "description": "Reinforcement boost added to facts search score (default: 0.1)"
          },
          "reinforcementProcedureBoost": {
            "type": "number",
            "description": "Reinforcement boost for procedures search (default: 0.1)"
          },
          "reinforcementPromotionThreshold": {
            "type": "number",
            "description": "Reinforcements to trigger auto-promotion of procedures (default: 2)"
          }
        }
      },
      "languageKeywords": {
        "type": "object",
        "additionalProperties": false,
        "description": "Multi-language detection: auto-build .language-keywords.json from memory samples (triggers, categories, correction signals).",
        "properties": {
          "autoBuild": {
            "type": "boolean",
            "description": "When true, build once at startup if file missing, then weekly (default: true)"
          },
          "weeklyIntervalDays": {
            "type": "number",
            "minimum": 1,
            "maximum": 30,
            "description": "Days between auto-builds (default: 7)"
          }
        }
      },
      "reflection": {
        "type": "object",
        "additionalProperties": false,
        "description": "Synthesize behavioral patterns from facts (memory_reflect, reflect-rules).",
        "properties": {
          "enabled": {
            "type": "boolean",
            "description": "Enable reflection layer (default: false)"
          },
          "model": {
            "type": "string",
            "description": "LLM for reflection (default: gpt-4o-mini)"
          },
          "defaultWindow": {
            "type": "number",
            "description": "Time window in days for fact gathering (default: 14)"
          },
          "minObservations": {
            "type": "number",
            "description": "Min observations to support a pattern (default: 2)"
          }
        }
      },
      "wal": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "enabled": {
            "type": "boolean",
            "description": "Enable Write-Ahead Log for crash resilience (default: true)"
          },
          "walPath": {
            "type": "string",
            "description": "Path to WAL file (default: same directory as SQLite DB)"
          },
          "maxAge": {
            "type": "number",
            "description": "Maximum age of WAL entries before considered stale in ms (default: 300000 = 5 minutes)"
          }
        },
        "description": "Write-Ahead Log for crash resilience (enabled by default)"
      },
      "personaProposals": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "enabled": {
            "type": "boolean",
            "description": "Enable agent self-evolution via gated persona proposals (default: false)"
          },
          "allowedFiles": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "SOUL.md",
                "IDENTITY.md",
                "USER.md"
              ]
            },
            "description": "Identity files that can be modified via proposals"
          },
          "maxProposalsPerWeek": {
            "type": "number",
            "description": "Max proposals per week to prevent spam (default: 5)"
          },
          "minConfidence": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "Min confidence score for proposals (default: 0.7)"
          },
          "proposalTTLDays": {
            "type": "number",
            "description": "Days before proposals auto-expire (default: 30, 0 = never)"
          },
          "minSessionEvidence": {
            "type": "number",
            "description": "Min session evidence count (default: 10)"
          }
        },
        "description": "Opt-in persona proposals: agent self-evolution with human approval gate (disabled by default)"
      },
      "graph": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "enabled": {
            "type": "boolean",
            "description": "Enable graph-based spreading activation for zero-LLM recall"
          },
          "autoLink": {
            "type": "boolean",
            "description": "Auto-create RELATED_TO links to similar facts when storing (default: false)"
          },
          "autoLinkMinScore": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "Min similarity score for auto-linking (default: 0.7)"
          },
          "autoLinkLimit": {
            "type": "number",
            "description": "Max similar facts to link per storage (default: 3)"
          },
          "maxTraversalDepth": {
            "type": "number",
            "description": "Max hops for graph traversal in recall (default: 2)"
          },
          "useInRecall": {
            "type": "boolean",
            "description": "Enable graph traversal in memory_recall (default: true)"
          }
        },
        "description": "Graph-based spreading activation: typed relationships for zero-LLM recall"
      },
      "procedures": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "enabled": {
            "type": "boolean",
            "description": "Enable procedural memory (default: true)"
          },
          "sessionsDir": {
            "type": "string",
            "description": "Session JSONL directory (default: ~/.openclaw/agents/main/sessions)"
          },
          "minSteps": {
            "type": "number",
            "description": "Min tool steps per procedure (default: 2)"
          },
          "validationThreshold": {
            "type": "number",
            "description": "Validations before auto-skill (default: 3)"
          },
          "skillTTLDays": {
            "type": "number",
            "description": "Procedure TTL days (default: 30)"
          },
          "skillsAutoPath": {
            "type": "string",
            "description": "Path for auto-generated skills (default: skills/auto)"
          },
          "requireApprovalForPromote": {
            "type": "boolean",
            "description": "Require human move to promote auto-skill (default: true)"
          }
        },
        "description": "Procedural memory: auto-generated skills from learned patterns"
      },
      "memoryToSkills": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "enabled": {
            "type": "boolean",
            "description": "Enable memory-to-skills pipeline (default: same as procedures.enabled)"
          },
          "schedule": {
            "type": "string",
            "description": "Cron schedule for nightly run (default: 0 2 * * *)"
          },
          "windowDays": {
            "type": "number",
            "description": "Procedures updated in last N days (default: 30)"
          },
          "minInstances": {
            "type": "number",
            "description": "Minimum procedure instances per cluster (default: 3)"
          },
          "consistencyThreshold": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "Step consistency threshold 0-1 (default: 0.7)"
          },
          "outputDir": {
            "type": "string",
            "description": "Output directory relative to workspace (default: skills/auto-generated)"
          },
          "notify": {
            "type": "boolean",
            "description": "Cron message asks agent to notify on new drafts (default: true)"
          },
          "autoPublish": {
            "type": "boolean",
            "description": "Always require human review; no auto-promote (default: false)"
          }
        },
        "description": "Memory-to-skills: cluster procedures, synthesize SKILL.md drafts (issue #114)"
      },
      "selfCorrection": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "semanticDedup": {
            "type": "boolean",
            "description": "Skip storing facts that are semantically similar to existing ones (default: true)"
          },
          "semanticDedupThreshold": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "Similarity threshold for semantic dedup, 0-1 (default: 0.92)"
          },
          "toolsSection": {
            "type": "string",
            "description": "TOOLS.md section heading for new rules (default: Self-correction rules)"
          },
          "applyToolsByDefault": {
            "type": "boolean",
            "description": "When true (default), insert suggested TOOLS rules under toolsSection. Set false to only suggest (use --approve to apply). Use --no-apply-tools to skip applying for one run."
          },
          "autoRewriteTools": {
            "type": "boolean",
            "description": "When true, LLM rewrites TOOLS.md to integrate new rules (no duplicates/contradictions). When false, use section insert (default: false)"
          },
          "analyzeViaSpawn": {
            "type": "boolean",
            "description": "When true and incidents > spawnThreshold, run Phase 2 via openclaw sessions spawn (Gemini, large context) (default: false)"
          },
          "spawnThreshold": {
            "type": "number",
            "description": "Use spawn for Phase 2 when incident count exceeds this (default: 15)"
          },
          "spawnModel": {
            "type": "string",
            "description": "Model for spawn when analyzeViaSpawn is true. Empty or unset = use provider default from config (Gemini/OpenAI/Claude, same as maintenance cron jobs)"
          }
        },
        "description": "Self-correction analysis: semantic dedup, TOOLS sectioning, auto-rewrite vs approve, optional Phase 2 via spawn"
      },
      "multiAgent": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "orchestratorId": {
            "type": "string",
            "description": "Agent ID of the orchestrator (main agent). This agent sees all scopes. Default: 'main'."
          },
          "defaultStoreScope": {
            "type": "string",
            "enum": [
              "global",
              "agent",
              "auto"
            ],
            "description": "Default scope for new facts: 'global' (all agents, backward compatible), 'agent' (specialists auto-scope), or 'auto' (orchestrator→global, specialists→agent). Default: 'global'."
          }
        },
        "description": "Multi-agent memory scoping: dynamic agent detection and scope defaults"
      },
      "memoryTiering": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "enabled": {
            "type": "boolean",
            "description": "Enable dynamic memory tiering hot/warm/cold (default: true in normal+ presets)"
          },
          "hotMaxTokens": {
            "type": "number",
            "description": "Max tokens for HOT tier at session start (default: 2000)"
          },
          "compactionOnSessionEnd": {
            "type": "boolean",
            "description": "Run compaction on agent_end (default: true)"
          },
          "inactivePreferenceDays": {
            "type": "number",
            "description": "Days without access to treat as inactive (default: 7)"
          },
          "hotMaxFacts": {
            "type": "number",
            "description": "Cap HOT tier facts when promoting (default: 50)"
          }
        },
        "description": "Dynamic memory tiering: hot/warm/cold"
      },
      "ingest": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "paths": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Glob patterns relative to workspace (e.g. skills/**/*.md, TOOLS.md)"
          },
          "chunkSize": {
            "type": "number",
            "description": "Chunk size in chars for LLM extraction (default: 800)"
          },
          "overlap": {
            "type": "number",
            "description": "Overlap between chunks (default: 100)"
          }
        },
        "description": "Ingest workspace markdown files as facts"
      },
      "search": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "hydeEnabled": {
            "type": "boolean",
            "description": "Use HyDE query expansion for vector search (default: false)"
          },
          "hydeModel": {
            "type": "string",
            "description": "Model for HyDE generation (default: gpt-4o-mini)"
          }
        },
        "description": "Search tweaks: HyDE query expansion"
      }
    },
    "required": [
      "embedding"
    ]
  }
}
